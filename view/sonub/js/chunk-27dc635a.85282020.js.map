{"version":3,"sources":["webpack:///./src/x-vue/svg/CameraSvg.vue?fb4e","webpack:///./src/x-vue/svg/CameraSvg.vue","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?f8f4","webpack:///./src/x-vue/components/UploadButton.vue?06d2","webpack:///./src/x-vue/components/UploadButton.vue","webpack:///./src/x-vue/components/UploadButton.vue?25d3","webpack:///./src/x-vue/components/UploadButton.vue?04af","webpack:///./src/x-vue/components/push-notification/PushNotificationIcon.vue?34de","webpack:///./src/x-vue/components/push-notification/PushNotificationIcon.vue","webpack:///./src/x-vue/components/push-notification/PushNotificationIcon.vue?df5a","webpack:///./src/x-vue/components/push-notification/PushNotificationIcon.vue?426b","webpack:///./src/views/chat/ChatRoomPage.vue?cd33","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?b434","webpack:///./src/x-vue/components/chat/ChatMessageList.vue","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?6c4c","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?2f3a","webpack:///./src/views/chat/ChatRoomPage.vue","webpack:///./src/views/chat/ChatRoomPage.vue?12af","webpack:///./src/views/chat/ChatRoomPage.vue?3236"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","script","component","staticClass","style","width","defaultSize","height","on","onFileChange","api","instance","mounted","size","event","Promise","user","loggedIn","error","target","files","length","file","fileUpload","onProgress","res","$emit","progress","console","log","UploadButton","props","components","CameraSvg","onChangeSubscribeOrUnsubscribeTopic","model","value","data","postTopic","callback","$$v","$set","expression","_v","_s","_f","title","rawTopic","topic","isSubscribedToTopic","subscribedByDefault","re","topicSubscription","subscribe","default","PushNotificationIcon","room","_e","otherUser","getTitle","idx","nicknameOrName","global","roomId","ref","changeRoomTitle","leaveRoom","messageListId","$event","scrollEventHandler","_l","m","key","id","class","isMine","refInFor","editMessage","onMouseDown","onMouseUp","rendered","text","onImageLoadComplete","preventDefault","showImagePreview","onSuccess","directives","name","rawName","domProps","type","indexOf","_k","keyCode","sendMessage","apply","arguments","composing","cancelEdit","scopedSlots","_u","fn","fileImagePreviewUrl","proxy","$bvModal","hide","sending","chatRoomSubscription","Subscription","extra","url","show","changes","atBottom","page","scrollToBottom","loadOtherUser","otherUserId","otherUserProfile","destroyed","unsubscribe","textInput","trim","tempText","isEdit","isMessageEdit","displayName","$refs","testInput","focus","sendMessageToUsers","users","subscription","body","click_action","promptToast","message","placement","TOP_CENTER","okCallback","updateTitle","confirm","leave","$router","push","thumbnailUrl","isImage","longPress","setTimeout","ChatMessageList","UserAvatar","enter","watchRoute","watchUid","roomInfo","$route","query","uid","alert","split","userProfile","usersInfo","otherUserInfo","firebaseUid","photoUrl","loggedInUserInfo","loginUserUid","store","state","Object","keys","updateGlobalRoomUsersInfo","$app","ChatUserRoomView","ChatRoom"],"mappings":"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","file":"js/chunk-27dc635a.85282020.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 512 512\"}},[_c('path',{attrs:{\"d\":\"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./CameraSvg.vue?vue&type=template&id=556f7269&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessageList.vue?vue&type=style&index=0&id=4931d64e&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pr-2 position-relative overflow-hidden pointer\"},[_c('camera-svg',{staticClass:\"pointer\",style:({ width: (_vm.defaultSize + \"px\"), height: (_vm.defaultSize + \"px\") })}),_c('input',{staticClass:\"h-100 top right position-absolute fs-lg opacity-0 pointer\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileChange}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n// import { XHelper } from \"@/x-vue-helper/x-helper\";\nimport Vue from \"vue\";\nimport Component from \"vue-class-component\";\nimport { ApiService } from \"../services/api.service\";\nimport ComponentService from \"../services/component.service\";\nimport CameraSvg from \"@/x-vue/svg/CameraSvg.vue\";\n\ninterface HTMLInputEvent extends Event {\n  target: HTMLInputElement & EventTarget;\n}\n\n@Component({\n  props: [\"size\"],\n  components: { CameraSvg },\n})\nexport default class UploadButton extends Vue {\n  size!: number;\n\n  /**\n   * Icon default size\n   */\n  defaultSize = 35;\n\n  api = ApiService.instance;\n\n  mounted(): void {\n    if (this.size) this.defaultSize = this.size;\n  }\n\n  async onFileChange(event: HTMLInputEvent): Promise<void> {\n    if (!this.api.user.loggedIn) {\n      ComponentService.instance.error(\"error_login_first\");\n      return;\n    }\n\n    if (event.target.files === null || event.target?.files?.length === 0) {\n      // console.log(\"User cancelled upload\");\n      return;\n    }\n    const file = event.target.files[0];\n\n    try {\n      const res = await this.api.fileUpload(file, {}, this.onProgress);\n      this.$emit(\"success\", res);\n    } catch (e) {\n      // XHelper.instance.error(e);\n      ComponentService.instance.error(e);\n    }\n  }\n\n  onProgress(progress: number): void {\n    console.log(progress);\n    this.$emit(\"progress\", progress);\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UploadButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UploadButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./UploadButton.vue?vue&type=template&id=54a32098&\"\nimport script from \"./UploadButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./UploadButton.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"push-notification-icon\"},[_c('b-form-checkbox',{attrs:{\"name\":\"check-button\",\"switch\":\"\"},on:{\"change\":_vm.onChangeSubscribeOrUnsubscribeTopic},model:{value:(_vm.data[_vm.postTopic]),callback:function ($$v) {_vm.$set(_vm.data, _vm.postTopic, $$v)},expression:\"data[postTopic]\"}},[_c('span',[_vm._v(_vm._s(_vm._f(\"t\")(_vm.title)))])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\nimport { ApiService } from \"@/x-vue/services/api.service\";\nimport Service from \"@/x-vue/services/component.service\";\nimport { Vue, Prop, Component } from \"vue-property-decorator\";\n\n@Component({})\nexport default class PushNotificationIcon extends Vue {\n  @Prop({ default: \"defaultTopic\" }) topic!: string;\n  @Prop({ default: \"\" }) rawTopic!: string;\n  @Prop({ default: \"\" }) title!: string;\n\n  @Prop({ default: false }) subscribedByDefault!: boolean;\n\n  // 'notifyPost_' is the prefix for post topic subscription\n  get postTopic(): string {\n    if (this.rawTopic.length) return this.rawTopic;\n    return \"notifyPost_\" + this.topic;\n  }\n\n  data: { [index: string]: boolean } = {\n    [this.postTopic]: false,\n  };\n\n  async mounted(): Promise<void> {\n    try {\n      const re = await ApiService.instance.isSubscribedToTopic(this.postTopic, this.subscribedByDefault);\n      this.data[this.postTopic] = re[this.postTopic] === \"Y\" ? true : false;\n    } catch (e) {\n      Service.instance.error(e);\n    }\n  }\n\n  async onChangeSubscribeOrUnsubscribeTopic(): Promise<void> {\n    if (!ApiService.instance.user.loggedIn) {\n      this.data[this.postTopic] = false;\n      Service.instance.error(\"error_login_first\");\n      return;\n    }\n    try {\n      await ApiService.instance.topicSubscription({\n        topic: this.postTopic,\n        subscribe: this.data[this.postTopic] ? \"Y\" : \"N\",\n      });\n    } catch (e) {\n      Service.instance.error(e);\n    }\n  }\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PushNotificationIcon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PushNotificationIcon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./PushNotificationIcon.vue?vue&type=template&id=53b593f6&\"\nimport script from \"./PushNotificationIcon.vue?vue&type=script&lang=ts&\"\nexport * from \"./PushNotificationIcon.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.room.id)?_c('ChatRoom'):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"chat-message d-flex flex-column\"},[_c('div',{staticClass:\"d-flex justify-content-between mb-2\"},[_c('div',{staticClass:\"admin-user-avatar d-flex align-items-center text-nowrap\"},[_c('UserAvatar',{staticClass:\"mr-2\",attrs:{\"user\":_vm.otherUser}}),_c('div',[(_vm.room.getTitle)?_c('div',[_vm._v(_vm._s(_vm.room.getTitle))]):(_vm.otherUser.idx)?_c('div',[_vm._v(\"(\"+_vm._s(_vm.otherUser.idx)+\") \"+_vm._s(_vm.otherUser.nicknameOrName))]):_vm._e()])],1),_c('div',{staticClass:\"chat-options d-flex align-items-center\"},[_c('PushNotificationIcon',{attrs:{\"rawTopic\":_vm.room.topic,\"subscribedByDefault\":true}}),_c('button',{staticClass:\"btn btn-sm py-2\",attrs:{\"id\":'chat-options-popover-' + _vm.room.global.roomId}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', 'cog'],\"size\":\"lg\"}})],1),_c('router-link',{staticClass:\"btn btn-sm py-2 pointer\",attrs:{\"to\":'/chat'}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', 'times'],\"size\":\"lg\"}})],1),_c('b-popover',{ref:\"popover\",attrs:{\"placement\":\"bottomleft\",\"target\":'chat-options-popover-' + _vm.room.global.roomId,\"triggers\":\"click blur\"}},[_c('div',{staticClass:\"p-2 pointer\",on:{\"click\":_vm.changeRoomTitle}},[_c('font-awesome-icon',{staticClass:\"mr-2\",attrs:{\"icon\":['fas', 'edit']}}),_vm._v(\" \"+_vm._s(_vm._f(\"t\")(\"edit_room_title\"))+\" \")],1),_c('router-link',{staticClass:\"p-2 pointer\",attrs:{\"to\":'/chat'}},[_c('font-awesome-icon',{staticClass:\"mr-2\",attrs:{\"icon\":['fas', 'list']}}),_vm._v(\" \"+_vm._s(_vm._f(\"t\")(\"goto_room_list\"))+\" \")],1),_c('div',{staticClass:\"p-2 pointer\",on:{\"click\":_vm.leaveRoom}},[_c('font-awesome-icon',{staticClass:\"mr-2\",attrs:{\"icon\":['fas', 'sign-out-alt']}}),_vm._v(\" \"+_vm._s(_vm._f(\"t\")(\"leave_room\"))+\" \")],1)],1)],1)]),_c('div',{staticClass:\"d-flex flex-column overflow-auto flex-grow-1 mb-2\",attrs:{\"id\":_vm.room.messageListId},on:{\"scroll\":function($event){return _vm.room.scrollEventHandler()}}},[_c('div',{staticClass:\"flex-grow-1\"}),(_vm.room.loading)?_c('div',{staticClass:\"py-2 mx-auto\"},[_c('b-spinner')],1):_vm._e(),_vm._l((_vm.room.messages),function(m){return _c('div',{key:m.id,staticClass:\"chat-bubble mb-1 rounded-lg my-1 p-2 text-break white\",class:m.isMine ? 'text-right my-chat ml-auto' : 'text-left other-chat mr-auto',attrs:{\"id\":'chat-message-popover-' + m.id}},[(m.canEdit)?_c('b-popover',{ref:\"popover\",refInFor:true,attrs:{\"placement\":\"left\",\"target\":'chat-message-popover-' + m.id,\"triggers\":\"hover focus\"}},[_c('div',{staticClass:\"pointer\",on:{\"click\":function($event){return _vm.room.editMessage(m)}}},[_c('font-awesome-icon',{staticClass:\"mr-2\",attrs:{\"icon\":['fas', 'edit']}}),_vm._v(\" \"+_vm._s(_vm._f(\"t\")(\"edit\"))+\" \")],1)]):_vm._e(),(m.isMine)?_c('div',{on:{\"mousedown\":function($event){return _vm.onMouseDown(m)},\"mouseup\":function($event){return _vm.onMouseUp(m)}}},[(m.isImage)?_c('div',[(!m.rendered)?_c('b-spinner'):_vm._e(),_c('b-img',{attrs:{\"src\":m.text,\"fluid\":\"\",\"alt\":m.text},on:{\"load\":function($event){return _vm.room.onImageLoadComplete(m)},\"click\":function($event){$event.preventDefault();return _vm.showImagePreview(m)}}})],1):(m.isMovie)?_c('div',[_c('video',{attrs:{\"width\":\"320\",\"height\":\"240\",\"controls\":\"\"}},[_c('source',{attrs:{\"src\":m.text}}),_vm._v(\" Your browser does not support the video tag. \")])]):_c('div',[_vm._v(_vm._s(_vm.room.text(m, true)))])]):_c('div',[(m.isImage)?_c('div',[(!m.rendered)?_c('b-spinner'):_vm._e(),_c('b-img',{attrs:{\"src\":m.text,\"fluid\":\"\",\"alt\":m.text},on:{\"load\":function($event){return _vm.room.onImageLoadComplete(m)},\"click\":function($event){$event.preventDefault();return _vm.showImagePreview(m)}}})],1):(m.isMovie)?_c('div',[_c('video',{attrs:{\"width\":\"320\",\"height\":\"240\",\"controls\":\"\"}},[_c('source',{attrs:{\"src\":m.text}}),_vm._v(\" Your browser does not support the video tag. \")])]):_c('div',[_vm._v(_vm._s(_vm.room.text(m, true)))])])],1)})],2),(_vm.progress && _vm.progress != 100)?_c('b-progress',{staticClass:\"mb-3 ml-2 mr-2\",attrs:{\"value\":_vm.progress,\"max\":\"100\"}}):_vm._e(),_c('div',{staticClass:\"d-flex\"},[_c('div',[_c('UploadButton',{on:{\"success\":_vm.onSuccess,\"progress\":function($event){_vm.progress = $event}}})],1),_c('div',{staticClass:\"w-100 position-relative\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.room.textInput),expression:\"room.textInput\"}],ref:\"testInput\",staticClass:\"w-100 py-1\",attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.room.textInput)},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.sendMessage.apply(null, arguments)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.room, \"textInput\", $event.target.value)}}}),(_vm.room.isMessageEdit)?_c('div',{staticClass:\"red position-absolute top right py-1 px-2\",on:{\"click\":function($event){return _vm.room.cancelEdit()}}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', 'times']}})],1):_vm._e()]),_c('button',{staticClass:\"btn btn-sm btn-primary ml-2 px-5\",on:{\"click\":_vm.sendMessage}},[_vm._v(_vm._s(_vm._f(\"t\")(\"Send\")))])]),_c('b-modal',{attrs:{\"id\":'file-preview-modal',\"hide-footer\":\"\"},scopedSlots:_vm._u([{key:\"modal-title\",fn:function(){return [_vm._v(_vm._s(_vm.fileImagePreviewUrl))]},proxy:true}])},[_c('div',[_c('b-img',{attrs:{\"src\":_vm.fileImagePreviewUrl,\"fluid\":\"\",\"alt\":_vm.fileImagePreviewUrl}})],1),_c('b-button',{staticClass:\"mt-3\",attrs:{\"block\":\"\"},on:{\"click\":function($event){return _vm.$bvModal.hide('file-preview-modal')}}},[_vm._v(\"Close\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { FileModel, UserModel } from \"@/x-vue/interfaces/interfaces\";\nimport { ApiService } from \"@/x-vue/services/api.service\";\nimport { ChatRoomService } from \"@/x-vue/services/chat/chat.room.service\";\nimport ComponentService, { PLACEMENT } from \"@/x-vue/services/component.service\";\nimport { Subscription } from \"rxjs\";\nimport { Vue, Component } from \"vue-property-decorator\";\n\nimport UploadButton from \"@/x-vue/components/UploadButton.vue\";\nimport UserAvatar from \"@/x-vue/components/user/UserAvatar.vue\";\nimport { isImageUrl } from \"@/x-vue/services/chat/chat.functions\";\n\nimport PushNotificationIcon from \"@/x-vue/components/push-notification/PushNotificationIcon.vue\";\nimport { ChatMessageModel } from \"@/x-vue/services/chat/chat.interface\";\nimport { t } from \"@/x-vue/services/functions\";\n\n@Component({\n  components: {\n    UserAvatar,\n    UploadButton,\n    PushNotificationIcon,\n  },\n})\nexport default class ChatMessageList extends Vue {\n  room = ChatRoomService.instance;\n\n  sending = false;\n\n  chatRoomSubscription: Subscription = new Subscription();\n\n  otherUser: UserModel = new UserModel();\n\n  fileImagePreviewUrl = \"\";\n  progress = 0;\n\n  showImagePreview(m: ChatMessageModel): void {\n    this.fileImagePreviewUrl = \"\" + m.extra.url;\n    this.$bvModal.show(\"file-preview-modal\");\n  }\n\n  mounted(): void {\n    this.chatRoomSubscription = ChatRoomService.instance.changes.subscribe(() => {\n      if (ChatRoomService.instance.atBottom || ChatRoomService.instance.page == 1) {\n        ChatRoomService.instance.scrollToBottom();\n      }\n    });\n\n    this.loadOtherUser();\n  }\n\n  async loadOtherUser(): Promise<void> {\n    if (!ChatRoomService.instance.global.otherUserId) return;\n    const otherUserId: string = ChatRoomService.instance.global.otherUserId;\n    try {\n      this.otherUser = await ApiService.instance.otherUserProfile(otherUserId);\n    } catch (error) {\n      ComponentService.instance.error(error);\n    }\n  }\n\n  destroyed(): void {\n    console.log(\"ChatMessageListScreen::destroyed()\");\n    ChatRoomService.instance.unsubscribe();\n    this.chatRoomSubscription.unsubscribe();\n  }\n\n  async sendMessage(): Promise<void> {\n    if (this.room.textInput.trim().length == 0 || this.sending) return;\n    this.sending = true;\n    const tempText: string = this.room.textInput;\n    this.room.textInput = \"\";\n    try {\n      const isEdit = this.room.isMessageEdit;\n      await this.room.sendMessage({\n        text: tempText,\n        displayName: ApiService.instance.user.nicknameOrName,\n      });\n      this.sending = false;\n\n      (this.$refs.testInput as HTMLElement)?.focus();\n\n      if (isEdit == null) {\n        /// Send Push Notification Silently\n        ApiService.instance.sendMessageToUsers({\n          users: this.room.otherUserId,\n          subscription: this.room.topic,\n          title: ApiService.instance.user.nicknameOrName + \" \" + t(\"sent_a_message\"),\n          body: tempText,\n          click_action: \"chat-message?id=\" + this.room.id,\n          data: {\n            type: \"chat\",\n            roomId: this.room.id,\n          },\n        });\n      }\n    } catch (e) {\n      ComponentService.instance.error(e);\n\n      this.sending = false;\n    }\n  }\n\n  async changeRoomTitle(): Promise<void> {\n    ComponentService.instance.promptToast({\n      title: \"Change Room Title\",\n      message: this.room.getTitle,\n      placement: PLACEMENT.TOP_CENTER,\n      okCallback: async (title: string): Promise<void> => {\n        console.log(\"title\", title);\n        try {\n          await this.room.updateTitle(title);\n        } catch (error) {\n          ComponentService.instance.error(error);\n        }\n      },\n      // cancelCallback: () => console.log(\"no\"),\n    });\n  }\n\n  async leaveRoom(): Promise<void> {\n    try {\n      const re = await ComponentService.instance.confirm(\"Chat Room delete\", \"Do you want to delete this chat room?\");\n      if (re === false) return;\n\n      await this.room.leave();\n      this.$router.push(\"/chat\");\n    } catch (e) {\n      ComponentService.instance.error(e);\n    }\n  }\n\n  async onSuccess(file: FileModel): Promise<void> {\n    console.log(\"onSuccess::\", file);\n\n    try {\n      await this.room.sendMessage({\n        text: isImageUrl(file.url) ? file.thumbnailUrl : file.url,\n        displayName: ApiService.instance.user.nicknameOrName,\n        extra: { url: file.url },\n      });\n      this.sending = false;\n      /// Send Push Notification Silently\n      ApiService.instance.sendMessageToUsers({\n        users: this.room.otherUserId,\n        subscription: this.room.topic,\n        title: ApiService.instance.user.nicknameOrName + \" \" + t(\"sent_a_message\"),\n        body: t(\"sent_a_file\"),\n        click_action: \"chat-message?id=\" + this.room.id,\n        data: {\n          type: \"chat\",\n          roomId: this.room.id,\n        },\n      });\n\n      (this.$refs.testInput as HTMLElement)?.focus();\n    } catch (e) {\n      ComponentService.instance.error(e);\n\n      this.sending = false;\n    }\n  }\n\n  onMouseDown(message: ChatMessageModel): void {\n    console.log(message.isImage);\n    if (!message.isMine) return;\n    message.longPress = true;\n    // console.log(\"onMouseDown\", message.longPress);\n    setTimeout(() => {\n      // console.log(\"onMouseDown\", message.longPress);\n      if (message.longPress) {\n        console.log(\"show edit\");\n        // $('#chat-message-popover-' + message.id).popover('show')\n      }\n    }, 2000);\n  }\n\n  onMouseUp(message: ChatMessageModel): void {\n    if (!message.isMine) return;\n    message.longPress = false;\n    // console.log(\"onMouseUp\", message.longPress);\n  }\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessageList.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessageList.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ChatMessageList.vue?vue&type=template&id=4931d64e&scoped=true&\"\nimport script from \"./ChatMessageList.vue?vue&type=script&lang=ts&\"\nexport * from \"./ChatMessageList.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ChatMessageList.vue?vue&type=style&index=0&id=4931d64e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4931d64e\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport { Component, Watch } from \"vue-property-decorator\";\nimport { ChatRoomEnter, ChatRoomService } from \"@/x-vue/services/chat/chat.room.service\";\n\nimport ChatRoom from \"@/x-vue/components/chat/ChatMessageList.vue\";\nimport { ApiService } from \"@/x-vue/services/api.service\";\nimport { AppService } from \"@/service/app.service\";\nimport store from \"@/store\";\n\n@Component({\n  components: {\n    ChatRoom,\n  },\n})\nexport default class ChatUserRoomView extends Vue {\n  room = ChatRoomService.instance;\n\n  mounted(): void {\n    // console.log(\"ChatUserRoomView::ChatRoom; \");\n    this.enter();\n  }\n\n  @Watch(\"$route.query.id\")\n  watchRoute(): void {\n    this.enter();\n  }\n\n  @Watch(\"$route.query.uid\")\n  watchUid(): void {\n    this.enter();\n  }\n\n  async enter(): Promise<void> {\n    const roomInfo: ChatRoomEnter = {\n      displayName: AppService.instance.user.displayName,\n    };\n    // @todo change query.id to query.roomId\n    if (this.$route.query.id != null) {\n      roomInfo.id = \"\" + this.$route.query.id;\n    } else if (this.$route.query.uid) {\n      roomInfo.users = (this.$route.query.uid as string).split(\",\");\n    } else {\n      return AppService.instance.alert(\"Missing params\", \"missing id or users firebaseUid\");\n    }\n\n    // if (this.$route.query.hatch != null) {\n    //   roomInfo.hatch = this.$route.query.hatch == \"true\" ? true : false;\n    // }\n\n    try {\n      await this.room.enter(roomInfo);\n      if (this.room.global.otherUserId) {\n        const otherUserProfile = await ApiService.instance.otherUserProfile(this.room.global.otherUserId);\n\n        // const userProfile = await ApiService.instance.userProfile();\n        const userProfile = ApiService.instance.user;\n\n        console.log(\"enter::otherUserProfile::\", otherUserProfile);\n        console.log(\"enter::userProfile::\", userProfile);\n        // eslint-disable-next-line  @typescript-eslint/no-explicit-any\n        let usersInfo: Record<string, any> = {};\n        // room was created/usersInfo is not set\n        if (!this.room.global.usersInfo) {\n          usersInfo = {\n            [otherUserProfile.firebaseUid]: {\n              photoUrl: otherUserProfile.photoUrl,\n              displayName: otherUserProfile.nicknameOrName,\n            },\n            [this.room.loginUserUid]: {\n              photoUrl: store.state.user.photoUrl,\n              displayName: store.state.user.nicknameOrName,\n            },\n          };\n        } else {\n          // check if the userInfo has been change, if yes then update\n          // if no changes then skip\n          const otherUserInfo = this.room.global.usersInfo[otherUserProfile.firebaseUid];\n          if (!otherUserInfo) {\n            usersInfo[otherUserProfile.firebaseUid] = {\n              photoUrl: otherUserProfile.photoUrl,\n              displayName: otherUserProfile.nicknameOrName,\n            };\n          } else {\n            if (otherUserInfo.displayName != otherUserProfile.nicknameOrName) {\n              if (!usersInfo[otherUserProfile.firebaseUid]) usersInfo[otherUserProfile.firebaseUid] = {};\n              usersInfo[otherUserProfile.firebaseUid].displayName = otherUserProfile.nicknameOrName;\n            }\n            if (otherUserInfo.photoUrl != otherUserProfile.photoUrl) {\n              if (!usersInfo[otherUserProfile.firebaseUid]) usersInfo[otherUserProfile.firebaseUid] = {};\n              usersInfo[otherUserProfile.firebaseUid].photoUrl = otherUserProfile.photoUrl;\n            }\n          }\n\n          const loggedInUserInfo = this.room.global.usersInfo[this.room.loginUserUid];\n          if (!loggedInUserInfo) {\n            usersInfo[this.room.loginUserUid] = {\n              photoUrl: store.state.user.photoUrl,\n              displayName: store.state.user.nicknameOrName,\n            };\n          } else {\n            if (loggedInUserInfo.displayName != store.state.user.nicknameOrName) {\n              if (!usersInfo[this.room.loginUserUid]) usersInfo[this.room.loginUserUid] = {};\n              usersInfo[this.room.loginUserUid].displayName = store.state.user.nicknameOrName;\n            }\n            console.log(loggedInUserInfo.photoUrl, store.state.user.photoUrl);\n            if (loggedInUserInfo.photoUrl != store.state.user.photoUrl) {\n              if (!usersInfo[this.room.loginUserUid]) usersInfo[this.room.loginUserUid] = {};\n              usersInfo[this.room.loginUserUid].photoUrl = store.state.user.photoUrl;\n            }\n          }\n        }\n        console.log(\"usersInfo::\", Object.keys(usersInfo).length, usersInfo);\n        if (Object.keys(usersInfo).length) this.room.updateGlobalRoomUsersInfo(usersInfo);\n      }\n    } catch (e) {\n      this.$app.error(e);\n    }\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatRoomPage.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatRoomPage.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ChatRoomPage.vue?vue&type=template&id=06d0284f&\"\nimport script from \"./ChatRoomPage.vue?vue&type=script&lang=ts&\"\nexport * from \"./ChatRoomPage.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}