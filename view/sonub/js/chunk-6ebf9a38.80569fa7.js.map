{"version":3,"sources":["webpack:///./src/views/chat/ChatUserRoom.vue?d286","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?da44","webpack:///./src/x-vue/components/chat/ChatMessageList.vue","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?6c4c","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?2f3a","webpack:///./src/views/chat/ChatUserRoom.vue","webpack:///./src/views/chat/ChatUserRoom.vue?3a74","webpack:///./src/views/chat/ChatUserRoom.vue?2280","webpack:///./src/x-vue/components/chat/ChatMessageList.vue?70dc"],"names":["render","_vm","this","_h","$createElement","_c","_self","chat","room","_e","staticRenderFns","staticClass","attrs","otherUser","global","_v","_s","title","idx","nicknameOrName","roomId","ref","on","leaveRoom","_f","messageListId","$event","scrollController","_l","m","key","id","class","senderUid","loginUserUid","text","directives","name","rawName","value","expression","domProps","target","composing","$set","sendMessage","instance","sending","chatRoomSubscription","Subscription","mounted","changes","subscribe","message","console","log","atBottom","page","scrollToBottom","loadOtherUser","Promise","otherUserId","userGet","firebaseUid","error","destroyed","unsubscribe","textInput","trim","length","tempText","displayName","$refs","testInput","focus","leave","$router","push","ChatMessageList","components","UserAvatar","component","enter","roomInfo","$route","query","users","split","hatch","e","$app","ChatUserRoomView"],"mappings":"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","file":"js/chunk-6ebf9a38.80569fa7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.chat.room.id)?_c('ChatMessageList'):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"chat-message d-flex flex-column\"},[_c('div',{staticClass:\"d-flex justify-content-between mb-2\"},[_c('div',{staticClass:\"admin-user-avatar d-flex align-items-center text-nowrap\"},[_c('UserAvatar',{staticClass:\"mr-2\",attrs:{\"user\":_vm.otherUser}}),_c('div',[(_vm.room.global.title)?_c('div',[_vm._v(_vm._s(_vm.room.global.title))]):(_vm.otherUser.idx)?_c('div',[_vm._v(\"(\"+_vm._s(_vm.otherUser.idx)+\") \"+_vm._s(_vm.otherUser.nicknameOrName))]):_vm._e()])],1),_c('div',{staticClass:\"chat-options d-flex align-items-center\"},[_c('button',{staticClass:\"btn btn-sm py-2\",attrs:{\"id\":'chat-options-popover-' + _vm.room.global.roomId}},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', 'cog'],\"size\":\"lg\"}})],1),_c('b-popover',{ref:\"popover\",attrs:{\"placement\":\"bottomleft\",\"target\":'chat-options-popover-' + _vm.room.global.roomId,\"triggers\":\"click blur\"}},[_c('button',{staticClass:\"btn btn-sm btn-success\",attrs:{\"data-cy\":\"mine-edit-button\"},on:{\"click\":_vm.leaveRoom}},[_vm._v(\" \"+_vm._s(_vm._f(\"t\")(\"leave\"))+\" \")])])],1)]),_c('div',{staticClass:\"d-flex flex-column overflow-auto flex-grow-1 mb-2\",attrs:{\"id\":_vm.room.messageListId},on:{\"scroll\":function($event){return _vm.room.scrollController($event)}}},[_c('div',{staticClass:\"flex-grow-1\"}),(_vm.room.loading)?_c('b-spinner'):_vm._e(),_vm._l((_vm.room.messages),function(m){return _c('div',{key:m.id,staticClass:\"chat-bubble mb-1 rounded-lg my-1 px-2 text-break\",class:m.senderUid == _vm.room.loginUserUid ? 'text-right bg-primary ml-auto' : 'text-left bg-info mr-auto',attrs:{\"id\":m.id}},[_vm._v(\" \"+_vm._s(m.text)+\" \")])})],2),_c('div',{staticClass:\"d-flex\"},[_c('div',{staticClass:\"py-1 px-2 pointer\"},[_c('font-awesome-icon',{attrs:{\"icon\":['fas', 'camera'],\"size\":\"lg\"}})],1),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.room.textInput),expression:\"room.textInput\"}],ref:\"testInput\",staticClass:\"w-100\",attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.room.textInput)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.room, \"textInput\", $event.target.value)}}}),_c('button',{staticClass:\"btn btn-sm btn-primary ml-2 px-5\",on:{\"click\":_vm.sendMessage}},[_vm._v(_vm._s(_vm._f(\"t\")(\"Send\")))])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { UserModel } from \"@/x-vue/interfaces/interfaces\";\nimport { ApiService } from \"@/x-vue/services/api.service\";\nimport { ChatRoomService } from \"@/x-vue/services/chat/chat.room.service\";\nimport ComponentService from \"@/x-vue/services/component.service\";\nimport { Subscription } from \"rxjs\";\nimport { Vue, Component } from \"vue-property-decorator\";\n\nimport UserAvatar from \"@/x-vue/components/user/UserAvatar.vue\";\n\n@Component({\n  components: {\n    UserAvatar,\n  },\n})\nexport default class ChatMessageList extends Vue {\n  room = ChatRoomService.instance;\n\n  sending = false;\n\n  chatRoomSubscription: Subscription = new Subscription();\n\n  otherUser: UserModel = new UserModel();\n\n  mounted(): void {\n    this.chatRoomSubscription = ChatRoomService.instance.changes.subscribe((message) => {\n      console.log(\"chatRoomSubscription\", ChatRoomService.instance.atBottom, ChatRoomService.instance.page == 1);\n      if (ChatRoomService.instance.atBottom || ChatRoomService.instance.page == 1) {\n        ChatRoomService.instance.scrollToBottom();\n      }\n\n      console.log(\"message::changes::\", message);\n      // this.$nextTick(() => {\n      //   let elmnt = document.getElementById(`${message.id}`);\n      //   elmnt?.scrollIntoView(false);\n      // });\n      // let elmnt = document.getElementById(`${message.id}`);\n      // elmnt?.scrollIntoView(false);\n      // let elmnt = document.getElementById(\"chat-message-list\");\n      // elmnt?.scrollTo(0, elmnt.scrollHeight);\n    });\n\n    this.loadOtherUser();\n  }\n\n  async loadOtherUser(): Promise<void> {\n    try {\n      console.log(\"ChatRoomService.instance.global.otherUserId::\", ChatRoomService.instance.global.otherUserId);\n      this.otherUser = await ApiService.instance.userGet({\n        firebaseUid: ChatRoomService.instance.global.otherUserId as string,\n      });\n\n      console.log(\"loadOtherUser\", this.otherUser);\n    } catch (error) {\n      ComponentService.instance.error(error);\n    }\n  }\n\n  destroyed(): void {\n    console.log(\"ChatMessageListScreen::destroyed()\");\n    ChatRoomService.instance.unsubscribe();\n    this.chatRoomSubscription.unsubscribe();\n  }\n\n  async sendMessage(): Promise<void> {\n    if (this.room.textInput.trim().length == 0 || this.sending) return;\n    this.sending = true;\n    const tempText: string = this.room.textInput;\n    this.room.textInput = \"\";\n    try {\n      await this.room.sendMessage({\n        text: tempText,\n        displayName: this.room.displayName,\n      });\n      this.sending = false;\n\n      (this.$refs.testInput as HTMLElement)?.focus();\n    } catch (e) {\n      ComponentService.instance.error(e);\n\n      this.sending = false;\n    }\n  }\n\n  async leaveRoom(): Promise<void> {\n    await this.room.leave();\n    this.$router.push(\"/chat\");\n  }\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessageList.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessageList.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ChatMessageList.vue?vue&type=template&id=2803566b&scoped=true&\"\nimport script from \"./ChatMessageList.vue?vue&type=script&lang=ts&\"\nexport * from \"./ChatMessageList.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ChatMessageList.vue?vue&type=style&index=0&id=2803566b&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2803566b\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport { Component } from \"vue-property-decorator\";\nimport { ChatService } from \"@/x-vue/services/chat/chat.service\";\nimport { ChatRoomService } from \"@/x-vue/services/chat/chat.room.service\";\n\nimport ChatMessageList from \"@/x-vue/components/chat/ChatMessageList.vue\";\n\n@Component({\n  components: {\n    ChatMessageList,\n  },\n})\nexport default class ChatUserRoomView extends Vue {\n  chat = ChatService.instance;\n\n  mounted(): void {\n    console.log(\"ChatUserRoomView::ChatMessageList; \");\n    this.enter();\n  }\n\n  async enter(): Promise<void> {\n    const roomInfo: Record<string, unknown> = {};\n    if (this.$route.query.id != null) {\n      roomInfo[\"id\"] = this.$route.query.id;\n    } else if (this.$route.query.users) {\n      roomInfo[\"users\"] = (this.$route.query.users as string).split(\",\");\n    } else {\n      return console.log(\"missing id or users firebaseUid\");\n    }\n\n    if (this.$route.query.hatch != null) {\n      roomInfo[\"hatch\"] = this.$route.query.hatch == \"true\" ? true : false;\n    }\n\n    try {\n      ChatRoomService.instance.enter(roomInfo);\n    } catch (e) {\n      this.$app.error(e);\n    }\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatUserRoom.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatUserRoom.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ChatUserRoom.vue?vue&type=template&id=d35f617c&\"\nimport script from \"./ChatUserRoom.vue?vue&type=script&lang=ts&\"\nexport * from \"./ChatUserRoom.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessageList.vue?vue&type=style&index=0&id=2803566b&scoped=true&lang=css&\""],"sourceRoot":""}